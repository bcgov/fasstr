<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform an annual low or high-flow frequency analysis — compute_annual_frequencies • fasstr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Perform an annual low or high-flow frequency analysis — compute_annual_frequencies" />
<meta property="og:description" content="Performs a flow volume frequency analysis on annual statistics from a daily streamflow data set. Defaults to a low 
   flow frequency analysis using annual minimums. Set use_max = TRUE for annual high flow frequency analyses. Calculates 
   statistics from all values, unless specified. Function will calculate using all values in 'Values' column (no grouped analysis). 
   Analysis methodology replicates that from HEC-SSP. Returns a list of
   tibbles and plots." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fasstr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/fasstr.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/index.html">All Articles</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Tutorials</li>
    <li>
      <a href="../articles/fasstr_users_guide.html">General Usage</a>
    </li>
    <li>
      <a href="../articles/fasstr_trending_analysis.html">Computing Annual Trends</a>
    </li>
    <li>
      <a href="../articles/fasstr_frequency_analysis.html">Computing Volume Frequency Analyses</a>
    </li>
    <li>
      <a href="../articles/fasstr_full_analysis.html">Computing a Full Analysis</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Exploration</li>
    <li>
      <a href="../articles/articles/fasstr_dataRetrieval.html">Using USGS dataRetrieval data with fasstr</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Under the Hood</li>
    <li>
      <a href="../articles/fasstr_under_the_hood.html">Internal Workflows</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bcgov/fasstr/raw/master/fasstr_cheatsheet.pdf">
    <span class="fa fa-file-download"></span>
     
    Download Cheatsheet
  </a>
</li>
<li>
  <a href="https://github.com/bcgov/fasstr">
    <span class="fa fa-github fa-lg"></span>
     
    GitHub
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform an annual low or high-flow frequency analysis</h1>
    <small class="dont-index">Source: <a href='https://github.com/bcgov/fasstr/blob/master/R/compute_annual_frequencies.R'><code>R/compute_annual_frequencies.R</code></a></small>
    <div class="hidden name"><code>compute_annual_frequencies.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs a flow volume frequency analysis on annual statistics from a daily streamflow data set. Defaults to a low 
   flow frequency analysis using annual minimums. Set <code>use_max = TRUE</code> for annual high flow frequency analyses. Calculates 
   statistics from all values, unless specified. Function will calculate using all values in 'Values' column (no grouped analysis). 
   Analysis methodology replicates that from <a href='https://www.hec.usace.army.mil/software/hec-ssp/'>HEC-SSP</a>. Returns a list of
   tibbles and plots.</p>
    </div>

    <pre class="usage"><span class='fu'>compute_annual_frequencies</span><span class='op'>(</span>
  <span class='va'>data</span>,
  dates <span class='op'>=</span> <span class='va'>Date</span>,
  values <span class='op'>=</span> <span class='va'>Value</span>,
  <span class='va'>station_number</span>,
  roll_days <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>3</span>, <span class='fl'>7</span>, <span class='fl'>30</span><span class='op'>)</span>,
  roll_align <span class='op'>=</span> <span class='st'>"right"</span>,
  use_max <span class='op'>=</span> <span class='cn'>FALSE</span>,
  use_log <span class='op'>=</span> <span class='cn'>FALSE</span>,
  prob_plot_position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"weibull"</span>, <span class='st'>"median"</span>, <span class='st'>"hazen"</span><span class='op'>)</span>,
  prob_scale_points <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.9999</span>, <span class='fl'>0.999</span>, <span class='fl'>0.99</span>, <span class='fl'>0.9</span>, <span class='fl'>0.5</span>, <span class='fl'>0.2</span>, <span class='fl'>0.1</span>, <span class='fl'>0.02</span>, <span class='fl'>0.01</span>, <span class='fl'>0.001</span>,
    <span class='fl'>0.0001</span><span class='op'>)</span>,
  fit_distr <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"PIII"</span>, <span class='st'>"weibull"</span><span class='op'>)</span>,
  fit_distr_method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>fit_distr</span> <span class='op'>==</span> <span class='st'>"PIII"</span>, <span class='st'>"MOM"</span>, <span class='st'>"MLE"</span><span class='op'>)</span>,
  fit_quantiles <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.975</span>, <span class='fl'>0.99</span>, <span class='fl'>0.98</span>, <span class='fl'>0.95</span>, <span class='fl'>0.9</span>, <span class='fl'>0.8</span>, <span class='fl'>0.5</span>, <span class='fl'>0.2</span>, <span class='fl'>0.1</span>, <span class='fl'>0.05</span>, <span class='fl'>0.01</span><span class='op'>)</span>,
  plot_curve <span class='op'>=</span> <span class='cn'>TRUE</span>,
  water_year_start <span class='op'>=</span> <span class='fl'>1</span>,
  <span class='va'>start_year</span>,
  <span class='va'>end_year</span>,
  <span class='va'>exclude_years</span>,
  months <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>12</span>,
  ignore_missing <span class='op'>=</span> <span class='cn'>FALSE</span>,
  allowed_missing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>ignore_missing</span>, <span class='fl'>100</span>, <span class='fl'>0</span><span class='op'>)</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A data frame of daily data that contains columns of dates and flow values. Groupings and the <code>groups</code> argument
are not used for this function (i.e. station numbers). Leave blank if using <code>station_number</code> argument.</p></td>
    </tr>
    <tr>
      <th>dates</th>
      <td><p>Name of column in <code>data</code> that contains dates formatted YYYY-MM-DD. Only required if dates column name is not 
'Date' (default). Leave blank if using <code>station_number</code> argument.</p></td>
    </tr>
    <tr>
      <th>values</th>
      <td><p>Name of column in <code>data</code> that contains numeric flow values, in units of cubic metres per second.
Only required if values column name is not 'Value' (default). Leave blank if using <code>station_number</code> argument.</p></td>
    </tr>
    <tr>
      <th>station_number</th>
      <td><p>Character string vector of seven digit Water Survey of Canada station numbers (e.g. <code>"08NM116"</code>) of
which to extract daily streamflow data from a HYDAT database. Requires <code>tidyhydat</code> package and a HYDAT database.
Leave blank if using <code>data</code> argument.</p></td>
    </tr>
    <tr>
      <th>roll_days</th>
      <td><p>Numeric value of the number of days to apply a rolling mean. Default <code>1</code>.</p></td>
    </tr>
    <tr>
      <th>roll_align</th>
      <td><p>Character string identifying the direction of the rolling mean from the specified date, either by the first 
(<code>'left'</code>), last (<code>'right'</code>), or middle (<code>'center'</code>) day of the rolling n-day group of observations. 
Default <code>'right'</code>.</p></td>
    </tr>
    <tr>
      <th>use_max</th>
      <td><p>Logical value to indicate using maximums rather than the minimums for analysis. Default <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>use_log</th>
      <td><p>Logical value to indicate log-scale transforming of flow data before analysis. Default <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>prob_plot_position</th>
      <td><p>Character string indicating the plotting positions used in the frequency plots, one of <code>'weibull'</code>,
<code>'median'</code>, or <code>'hazen'</code>. Points are plotted against  (i-a)/(n+1-a-b) where <code>i</code> is the rank of the value; <code>n</code> is the 
sample size and <code>a</code> and <code>b</code> are defined as: (a=0, b=0) for Weibull plotting positions; (a=.2; b=.3) for Median 
plotting positions; and (a=.5; b=.5) for Hazen plotting positions. Default <code>'weibull'</code>.</p></td>
    </tr>
    <tr>
      <th>prob_scale_points</th>
      <td><p>Numeric vector of probabilities to be plotted along the X axis in the frequency plot. Inverse of 
return period. Default <code><a href='https://rdrr.io/r/base/c.html'>c(.9999, .999, .99, .9, .5, .2, .1, .02, .01, .001, .0001)</a></code>.</p></td>
    </tr>
    <tr>
      <th>fit_distr</th>
      <td><p>Character string identifying the distribution to fit annual data, one of <code>'PIII'</code> (Log Pearson Type III)
or <code>'weibull'</code> (Weibull) distributions. Default <code>'PIII'</code>.</p></td>
    </tr>
    <tr>
      <th>fit_distr_method</th>
      <td><p>Character string identifying the method used to fit the distribution, one of <code>'MOM'</code> (method of
moments) or <code>'MLE'</code> (maximum likelihood estimation). Selected as <code>'MOM'</code> if <code>fit_distr ='PIII'</code> (default) or 
<code>'MLE'</code> if <code>fit_distr = 'weibull'</code>.</p></td>
    </tr>
    <tr>
      <th>fit_quantiles</th>
      <td><p>Numeric vector of quantiles to be estimated from the fitted distribution. 
Default <code><a href='https://rdrr.io/r/base/c.html'>c(.975, .99, .98, .95, .90, .80, .50, .20, .10, .05, .01)</a></code>.</p></td>
    </tr>
    <tr>
      <th>plot_curve</th>
      <td><p>Logical value to indicate plotting the computed curve on the probability plot. Default <code>TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>water_year_start</th>
      <td><p>Numeric value indicating the month (<code>1</code> through <code>12</code>) of the start of water year for
analysis. Default <code>1</code>.</p></td>
    </tr>
    <tr>
      <th>start_year</th>
      <td><p>Numeric value of the first year to consider for analysis. Leave blank to use the first year of the source data.</p></td>
    </tr>
    <tr>
      <th>end_year</th>
      <td><p>Numeric value of the last year to consider for analysis. Leave blank to use the last year of the source data.</p></td>
    </tr>
    <tr>
      <th>exclude_years</th>
      <td><p>Numeric vector of years to exclude from analysis. Leave blank to include all years.</p></td>
    </tr>
    <tr>
      <th>months</th>
      <td><p>Numeric vector of months to include in analysis (e.g. <code>6:8</code> for Jun-Aug). Leave blank to summarize 
all months (default <code>1:12</code>).</p></td>
    </tr>
    <tr>
      <th>ignore_missing</th>
      <td><p>Logical value indicating whether dates with missing values should be included in the calculation. If
<code>TRUE</code> then a statistic will be calculated regardless of missing dates. If <code>FALSE</code> then only those statistics from
time periods with no missing dates will be returned. Default <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>allowed_missing</th>
      <td><p>Numeric value between 0 and 100 indicating the <strong>percentage</strong> of missing dates allowed to be
included to calculate a statistic (0 to 100 percent). If <code>'ignore_missing = FALSE'</code> then it defaults to <code>0</code> (zero missing dates allowed),
if <code>'ignore_missing = TRUE'</code> then it defaults to <code>100</code> (any missing dates allowed); consistent with 
<code>ignore_missing</code> usage. Supersedes <code>ignore_missing</code> when used.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with the following elements:</p>
<dt>Freq_Analysis_Data</dt><dd><p>Data frame with computed annual summary statistics used in analysis.</p></dd>
  <dt>Freq_Plot_Data</dt><dd><p>Data frame with co-ordinates used in frequency plot.</p></dd>
  <dt>Freq_Plot</dt><dd><p>ggplot2 object with frequency plot.</p></dd>
  <dt>Freq_Fitting</dt><dd><p>List of fitted objects from fitdistrplus.</p></dd>
  <dt>Freq_Fitted_Quantiles</dt><dd><p>Data frame with fitted quantiles.</p></dd>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='compute_frequency_analysis.html'>compute_frequency_analysis</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>

<span class='co'># Working examples (see arguments for further analysis options):</span>

<span class='co'># Compute an annual frequency analysis using default arguments</span>
<span class='va'>results</span> <span class='op'>&lt;-</span> <span class='fu'>compute_annual_frequencies</span><span class='op'>(</span>station_number <span class='op'>=</span> <span class='st'>"08NM116"</span>,
                                      start_year <span class='op'>=</span> <span class='fl'>1980</span>,
                                      end_year <span class='op'>=</span> <span class='fl'>2010</span><span class='op'>)</span>
                           
<span class='co'># Compute an annual frequency analysis using default arguments (as listed)</span>
<span class='va'>results</span> <span class='op'>&lt;-</span> <span class='fu'>compute_annual_frequencies</span><span class='op'>(</span>station_number <span class='op'>=</span> <span class='st'>"08NM116"</span>,
                                      roll_days <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>3</span>,<span class='fl'>7</span>,<span class='fl'>30</span><span class='op'>)</span>,
                                      start_year <span class='op'>=</span> <span class='fl'>1980</span>,
                                      end_year <span class='op'>=</span> <span class='fl'>2010</span>,
                                      prob_plot_position <span class='op'>=</span> <span class='st'>"weibull"</span>,
                                      prob_scale_points <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>.9999</span>, <span class='fl'>.999</span>, <span class='fl'>.99</span>, <span class='fl'>.9</span>, <span class='fl'>.5</span>, 
                                      <span class='fl'>.2</span>, <span class='fl'>.1</span>, <span class='fl'>.02</span>, <span class='fl'>.01</span>, <span class='fl'>.001</span>, <span class='fl'>.0001</span><span class='op'>)</span>,
                                      fit_distr <span class='op'>=</span> <span class='st'>"PIII"</span>,
                                      fit_distr_method <span class='op'>=</span> <span class='st'>"MOM"</span><span class='op'>)</span>
                                      
<span class='co'># Compute a 7-day annual frequency analysis with "median" plotting positions</span>
<span class='co'># and fitting the data to a weibull distribution (not default PIII)</span>
<span class='va'>results</span> <span class='op'>&lt;-</span> <span class='fu'>compute_annual_frequencies</span><span class='op'>(</span>station_number <span class='op'>=</span> <span class='st'>"08NM116"</span>,
                                      roll_days <span class='op'>=</span> <span class='fl'>7</span>,
                                      start_year <span class='op'>=</span> <span class='fl'>1980</span>,
                                      end_year <span class='op'>=</span> <span class='fl'>2010</span>,
                                      prob_plot_position <span class='op'>=</span> <span class='st'>"median"</span>,
                                      fit_distr <span class='op'>=</span> <span class='st'>"weibull"</span><span class='op'>)</span>
               
<span class='op'>}</span>            
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Jon Goetz, Carl James Schwarz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


